<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Your Ride</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css">
    <style>
        .map-container {
            height: 40vh;
            background-color: #e5e7eb;
            background-image: url('https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/90.399452,23.777176,13,0/600x400?access_token=pk.placeholder');
            background-size: cover;
            background-position: center;
        }
        .location-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #3b82f6;
            font-size: 2rem;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        .slide-up {
            transition: transform 0.3s ease-out;
            transform: translateY(0);
        }
        .slide-down {
            transform: translateY(100%);
        }
        .booking-panel {
            height: 60vh;
            overflow-y: auto;
        }
        .driver-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #6b7280;
        }
        .loading-pulse {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 20px;
        }
        .loading-pulse div {
            position: absolute;
            top: 8px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #3b82f6;
            animation-timing-function: cubic-bezier(0, 1, 1, 0);
        }
        .loading-pulse div:nth-child(1) {
            left: 8px;
            animation: loading-pulse1 0.6s infinite;
        }
        .loading-pulse div:nth-child(2) {
            left: 8px;
            animation: loading-pulse2 0.6s infinite;
        }
        .loading-pulse div:nth-child(3) {
            left: 32px;
            animation: loading-pulse2 0.6s infinite;
        }
        .loading-pulse div:nth-child(4) {
            left: 56px;
            animation: loading-pulse3 0.6s infinite;
        }
        @keyframes loading-pulse1 {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }
        @keyframes loading-pulse3 {
            0% { transform: scale(1); }
            100% { transform: scale(0); }
        }
        @keyframes loading-pulse2 {
            0% { transform: translate(0, 0); }
            100% { transform: translate(24px, 0); }
        }
    </style>
</head>
<body class="bg-gray-100 h-screen">
    <div class="flex flex-col h-full">
        <!-- Header -->
        <header class="bg-blue-600 text-white p-4 shadow-md">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-xl font-bold">Book Your Ride</h1>
                <div class="flex items-center">
                    <button id="profileBtn" class="p-2 rounded-full bg-blue-700">
                        <i class="fas fa-user"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Map Container -->
        <div class="relative map-container">
            <i class="fas fa-map-marker-alt location-dot"></i>
            <button id="recenterBtn" class="absolute bottom-4 right-4 bg-white p-3 rounded-full shadow-lg">
                <i class="fas fa-crosshairs text-blue-600"></i>
            </button>
        </div>

        <!-- Booking Panel -->
        <div class="booking-panel bg-white rounded-t-3xl -mt-6 relative z-10 flex-grow shadow-lg">
            <div class="w-16 h-1 bg-gray-300 rounded-full mx-auto mt-3"></div>
            
            <!-- Initial Booking Form -->
            <div id="bookingForm" class="p-4">
                <div class="mb-4">
                    <div class="bg-gray-100 p-3 rounded-lg flex items-center mb-2">
                        <i class="fas fa-dot-circle text-blue-600 mr-3"></i>
                        <div class="flex-grow">
                            <label class="text-xs text-gray-500">Your Current Location</label>
                            <div id="currentLocation" class="font-medium">Finding location...</div>
                        </div>
                    </div>
                    <div class="bg-gray-100 p-3 rounded-lg flex items-center">
                        <i class="fas fa-map-pin text-red-500 mr-3"></i>
                        <div class="flex-grow">
                            <label class="text-xs text-gray-500">Drop Location</label>
                            <input type="text" id="dropLocation" class="w-full bg-transparent outline-none font-medium" placeholder="Tap on map or enter destination">
                        </div>
                        <button id="favoriteBtn" class="text-gray-400 p-2">
                            <i class="far fa-heart"></i>
                        </button>
                    </div>
                </div>

                <!-- Ride Options -->
                <div class="mb-4">
                    <h3 class="text-lg font-semibold mb-2">Choose Ride Type</h3>
                    <div class="grid grid-cols-3 gap-2">
                        <div class="bg-blue-50 border-2 border-blue-500 p-3 rounded-lg text-center">
                            <i class="fas fa-car text-blue-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">Standard</div>
                            <div class="text-xs text-gray-500">₹150-200</div>
                        </div>
                        <div class="bg-gray-50 border border-gray-200 p-3 rounded-lg text-center">
                            <i class="fas fa-car-side text-gray-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">Premium</div>
                            <div class="text-xs text-gray-500">₹250-300</div>
                        </div>
                        <div class="bg-gray-50 border border-gray-200 p-3 rounded-lg text-center">
                            <i class="fas fa-shuttle-van text-gray-600 text-xl mb-2"></i>
                            <div class="text-sm font-medium">XL</div>
                            <div class="text-xs text-gray-500">₹350-400</div>
                        </div>
                    </div>
                </div>

                <!-- Ride Details -->
                <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <div class="flex justify-between mb-2">
                        <div class="text-gray-600">Estimated distance:</div>
                        <div class="font-semibold" id="distanceValue">5.2 km</div>
                    </div>
                    <div class="flex justify-between mb-2">
                        <div class="text-gray-600">Travel time:</div>
                        <div class="font-semibold" id="timeValue">18 min</div>
                    </div>
                    <div class="flex justify-between">
                        <div class="text-gray-600">Estimated cost:</div>
                        <div class="font-semibold" id="costValue">₹175</div>
                    </div>
                </div>

                <!-- Payment Method -->
                <div class="bg-gray-50 p-3 rounded-lg flex items-center justify-between mb-4">
                    <div class="flex items-center">
                        <i class="fas fa-money-bill-wave text-green-600 mr-3"></i>
                        <div>
                            <div class="font-medium">Cash Payment</div>
                            <div class="text-xs text-gray-500">Pay after your ride</div>
                        </div>
                    </div>
                    <button class="text-blue-600 text-sm font-medium">
                        Change
                    </button>
                </div>

                <!-- Book Button -->
                <button id="bookBtn" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold text-lg shadow-md hover:bg-blue-700 transition">
                    Book Now
                </button>
            </div>

            <!-- Searching for Drivers (Initially Hidden) -->
            <div id="searchingPanel" class="p-6 text-center hidden">
                <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-search text-blue-600 text-3xl"></i>
                </div>
                <h2 class="text-xl font-bold mb-2">Booking Confirmed!</h2>
                <p class="text-gray-600 mb-4">Searching for nearby drivers...</p>
                
                <div class="loading-pulse mx-auto mb-6">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <div class="flex justify-between mb-2">
                        <div class="text-gray-600">From:</div>
                        <div class="font-semibold text-right" id="fromLocationDisplay">Current Location</div>
                    </div>
                    <div class="flex justify-between">
                        <div class="text-gray-600">To:</div>
                        <div class="font-semibold text-right" id="toLocationDisplay">Science City, Kolkata</div>
                    </div>
                </div>
                
                <button id="cancelSearchBtn" class="w-full border border-gray-300 text-gray-700 py-3 rounded-lg font-semibold">
                    Cancel Booking
                </button>
            </div>

            <!-- Driver Found Panel (Initially Hidden) -->
            <div id="driverFoundPanel" class="p-6 hidden">
                <div class="bg-green-50 p-4 rounded-lg mb-4 text-center">
                    <i class="fas fa-check-circle text-green-500 text-2xl mb-2"></i>
                    <h2 class="font-bold text-lg">Driver Accepted!</h2>
                    <p class="text-sm text-gray-600">Your driver is on the way</p>
                </div>
                
                <div class="flex items-center mb-4">
                    <div class="driver-avatar mr-4 relative">
                        <i class="fas fa-user"></i>
                        <span class="absolute -right-1 -bottom-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"></span>
                    </div>
                    <div>
                        <div class="font-bold text-lg">Rahul Singh</div>
                        <div class="flex items-center">
                            <i class="fas fa-star text-yellow-400 text-sm mr-1"></i>
                            <span class="text-sm">4.8</span>
                            <span class="mx-2 text-gray-300">|</span>
                            <span class="text-sm text-gray-600">WB 01 AB 4567</span>
                        </div>
                        <div class="text-sm text-gray-600">White Hyundai i10</div>
                    </div>
                    <div class="ml-auto">
                        <button class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center mb-2">
                            <i class="fas fa-phone text-blue-600"></i>
                        </button>
                        <button class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                            <i class="fas fa-comment-alt text-blue-600"></i>
                        </button>
                    </div>
                </div>
                
                <div class="bg-blue-50 p-3 rounded-lg mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <div class="text-sm font-medium">Distance to your location:</div>
                        <div class="font-bold">1.3 km</div>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="text-sm font-medium">Arriving in:</div>
                        <div class="font-bold">6 minutes</div>
                    </div>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <div class="flex justify-between mb-2">
                        <div class="text-gray-600">From:</div>
                        <div class="font-semibold text-right">Current Location</div>
                    </div>
                    <div class="flex justify-between mb-2">
                        <div class="text-gray-600">To:</div>
                        <div class="font-semibold text-right">Science City, Kolkata</div>
                    </div>
                    <div class="flex justify-between mb-2">
                        <div class="text-gray-600">Distance:</div>
                        <div class="font-semibold">5.2 km</div>
                    </div>
                    <div class="flex justify-between">
                        <div class="text-gray-600">Total fare:</div>
                        <div class="font-semibold">₹175</div>
                    </div>
                </div>
                
                <button id="cancelRideBtn" class="w-full border border-gray-300 text-gray-700 py-3 rounded-lg font-semibold">
                    Cancel Ride
                </button>
            </div>
        </div>
    </div>

    <script>
        // Mock locations
        const locations = [
            "Salt Lake, Kolkata",
            "Park Street, Kolkata",
            "Howrah Bridge, Kolkata"
        ];
        
        // Display random location after a delay
        setTimeout(() => {
            document.getElementById('currentLocation').innerText = locations[Math.floor(Math.random() * locations.length)];
        }, 2000);
        
        // Book button functionality
        document.getElementById('bookBtn').addEventListener('click', function() {
            // Hide booking form
            document.getElementById('bookingForm').classList.add('hidden');
            // Show searching panel
            document.getElementById('searchingPanel').classList.remove('hidden');
            
            // Display selected locations
            const dropLocation = document.getElementById('dropLocation').value || "Science City, Kolkata";
            document.getElementById('toLocationDisplay').innerText = dropLocation;
            document.getElementById('fromLocationDisplay').innerText = document.getElementById('currentLocation').innerText;
            
            // Simulate finding a driver after 5 seconds
            setTimeout(() => {
                document.getElementById('searchingPanel').classList.add('hidden');
                document.getElementById('driverFoundPanel').classList.remove('hidden');
                
                // Send event to driver's page (in a real app, this would be via websockets or similar)
                // This is just a simulation
                console.log("Driver notification sent!");
            }, 5000);
        });
        
        // Cancel search button
        document.getElementById('cancelSearchBtn').addEventListener('click', function() {
            document.getElementById('searchingPanel').classList.add('hidden');
            document.getElementById('bookingForm').classList.remove('hidden');
        });
        
        // Cancel ride button
        document.getElementById('cancelRideBtn').addEventListener('click', function() {
            document.getElementById('driverFoundPanel').classList.add('hidden');
            document.getElementById('bookingForm').classList.remove('hidden');
        });
        
        // Recenter map button
        document.getElementById('recenterBtn').addEventListener('click', function() {
            alert("Map recentered to your current location");
        });
        
        // Initialize with some random values
        const updateRideDetails = () => {
            const distance = (3 + Math.random() * 7).toFixed(1);
            const time = Math.round(distance * 3.5);
            const cost = Math.round(distance * 35);
            
            document.getElementById('distanceValue').innerText = distance + " km";
            document.getElementById('timeValue').innerText = time + " min";
            document.getElementById('costValue').innerText = "₹" + cost;
        };
        
        updateRideDetails();
        
        // Update ride details when drop location changes
        document.getElementById('dropLocation').addEventListener('input', updateRideDetails);
    </script>
</body>
</html>
